import { Callout } from "nextra-theme-docs"
import { Tab, Tabs } from "nextra-theme-docs"

# ChannelMixer

Channel mixer that performs token-wise transformations on an input tensor.

```python copy
ChannelMixer(act_layer=nn.GELU.partial(), dim=768, expansion_factor=4)
```

This layer applies two EinMix layers in sequence to perform token-wise
transformations on the input tensor. The first EinMix layer expands
the number of channels by a specified expansion factor, and the second
EinMix layer reduces the number of channels back to its original value.

An activation layer can be inserted between the two EinMix layers.

## Parameters

- `act_layer`: Activation layer to be inserted
between the two EinMix layers.
- `dim = 1024`: Number of channels in the input tensor. Defaults to 1024.
- `expansion_factor`: Factor by which to expand
the number of channels in the first EinMix layer. Defaults to 4.

## Forward
```rust
(x: jaxtyping.Float[Tensor, '... d']) -> jaxtyping.Float[Tensor, '... d']
```

### Returns
Output tensor with the same dimensions
as the input tensor, but with the channels transformed by
the channel mixer.
